<link href='/lojas/00000009/htm/LojaSite.css' rel='stylesheet' type='text/css'>

<style>
body{font-size:10pt;font-family:tahoma,verdana}
pre {font-size:9pt;font-family: "Consolas", Courier New, Verdana;color:#0D6D9E;}
.courrier {font-size:9pt;font-family: "Consolas", Courier New, Verdana;color:#0D6D9E;}
.courrierpeq {font-size:8pt;font-family:courier new,tahoma,verdana;color:#0D6D9E;}
.tit {font-size:14pt}
.dest {font-size:09pt;font-family:tahoma,verdana;color:#990000;font-weight:bold;}
.destaque {font-size:08pt;font-family:tahoma,verdana;color:#990000;font-weight:bold;}
.destverde {font-size:10pt;font-family:tahoma,verdana;color:#139606;font-weight:bold;}
a.LinkAjudaDesign:link {color:black;text-decoration:none;font-family:verdana;font-size:11pt;}
a.LinkAjudaDesign:visited {color:#999999;text-decoration:none;text-decoration:none;font-family:verdana;font-size:11pt;}
a.LinkAjudaDesign:hover {color:navy;text-decoration:underline}
</style>

<body leftmargin=0 topmargin=0 marginwidth=0 marginheight=0 text=#333333 link=#0066CC vlink=#0066CC alink=#0099FF>


<table width="100%" border="0">
  <tr>
    <td><span class="destaque">ATENÇÃO: </span>A implantação deste recurso requer <b>CONHECIMENTOS AVANÇADOS</b> de <b>html</b> e <b>JavaScript</b>.<br><br>O conteúdo mencionado neste exemplo é apenas uma sugestão. A <b>Rumo Informática</b> não se responsabiliza por apresentar mais detalhes a respeito<br>de alterações e implantações.<br><br>Para mais informações, solicite recomendações de webdesigner ou entre em contato com o de sua preferência.<br><br></td>
  </tr>
  <tr>
    <td></td>
  </tr>
  <tr>
    <td><br /></td>
  </tr>
  <tr>
    <td><span class=destpeq>1º Passo</span><br />Envie o arquivo <b>arraste_htm.zip</b> para a pasta <b>htm</b> da loja:<br></td>
  </tr>
  <tr>
    <td></td>
  </tr>
  <tr>
    <td><b>Download: </b><a href="http://rumo.com.br/dnload/arraste_htm.zip">arraste_htm.zip</a><br></td>
  </tr>
  <tr>
    <td><br><br><br></td>
  </tr> 
  <tr>
    <td><span class=destpeq>2º Passo</span><br />Envie o arquivo <b>arraste_img.zip</b> para a pasta <b>images</b> da loja:<br></td>
  </tr>
  <tr>
    <td></td>
  </tr>
  <tr>
    <td><b>Download: </b><a href="http://rumo.com.br/dnload/arraste_img.zip">arraste_img.zip</a><br></td>
  </tr>
  <tr>
    <td><br><br><br></td>
  </tr> 
  <tr>
    <td><span class=destpeq>3º Passo</span><br />Insira as linhas abaixo no inicio do arquivo <b>BarraTopo.htm</b>:<br></td>
  </tr>
  <tr>
    <td><br></td>
  </tr>  				
  <tr>
    <td>
      <table cellpadding=10 cellspacing=1>
        <tr>
          <td><span class=courrierpeq>    
<pre>
&lt;script language="JavaScript" src="../sistema/jquery-1.7.2.min.js">&lt;/script>
&lt;script type="text/javascript" src="&lt;BaseLoja>htm/jquery_ui_min.js">&lt;/script>
&lt;script type="text/javascript" src="&lt;BaseLoja>htm/arraste.js">&lt;/script>
&lt;!--Cesta-->
&lt;div class="cesta">
  &lt;div id="carrinho-info">
    &lt;div id="x1">&lt;/div>
    &lt;div id="x2">&lt;/div>
  &lt;/div> 
  &lt;div id="carrinho-top">
    &lt;div id="carrinho-container">
      &lt;ul id="carrinho-produtos">
        &lt;li class="adicione">&lt;/li> 
      &lt;/ul>
      &lt;div style="width:100%; height:21px; display:block">&amp;nbsp;
        &lt;div id="result-adicao">&lt;/div>
      &lt;/div>
      &lt;div id="bot-cesta">&lt;a href="AddProduto.asp?IDLoja=&lt;IDLoja>">&lt;img src="&lt;BaseLoja>images/BtnCesta.png" width="298" height="21">&lt;/a>&lt;/div>
    &lt;/div>
  &lt;/div>
&lt;/div></pre>
            </span>
          </td>
        </tr>
      </table> 				
    </td>
  </tr>
  <tr>
    <td><br><br><br></td>
  </tr>
  <tr>
    <td><span class=destpeq>4º Passo</span><br />Adicione o script abaixo no final do arquivo <b>Rodape.htm</b><br></td>
  </tr>
  <tr>
    <td><br></td>
  </tr>
  <tr>
    <td>
      <table cellpadding=10 cellspacing=1>
        <tr>
          <td><span class=courrierpeq><pre>&lt;script type="text/javascript">AtualizaCarrinho();&lt;/script></pre></span></td>
        </tr>
      </table>
    </td>
  </tr>
  <tr>
    <td><br><br><br></td>
  </tr>
  <tr>
    <td><span class=destpeq>5º Passo</span><br />Adicione o script abaixo no final do arquivo <b>LojaLib.js</b><br></td>
  </tr>
  <tr>
    <td><br></td>
  </tr>
  <tr>
    <td>
      <table cellpadding=10 cellspacing=1>
        <tr>
          <td><span class=courrierpeq>
<pre>
function ShowCartOnPage(IDLoja,iErr,sMsg,sCartText,sCheckoutText,este){
  if(iErr==0)AtualizaCarrinho();
  if(sMsg=="Produto adicionado ao carrinho.")
    document.getElementById("result-adicao").innerHTML="&lt;div style='font-size:8pt; margin-left:65px'>&lt;img src='"+ FC$.PathImg +"btnok.png' width='21' height='21'>"+ sMsg +"&lt;/div>";
  else
    document.getElementById("result-adicao").innerHTML="&lt;div style='font-size:8pt; margin-left:9px'>&lt;img src='"+ FC$.PathImg +"btnnotok.png' width='21' height='21'>"+ sMsg +"&lt;/div>";
}
</pre>


<pre>
function AtualizaCarrinho(){
   if (window.XMLHttpRequest){xmlhttp=new XMLHttpRequest();}
   else{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");}
   xmlhttp.open("GET",'XMLCart.asp?IDLoja='+FC$.IDLoja,false);
   xmlhttp.send();
   xmlDoc=xmlhttp.responseXML; 
   var x=xmlDoc.getElementsByTagName("item");
   var z=xmlDoc.getElementsByTagName("cart");
   
   try{currencyProdCart=(z[0].getElementsByTagName("currency")[0].childNodes[0].nodeValue);}
   catch(e){currencyProdCart="R$"}
   
   try{TotalQtyProdCart=(z[0].getElementsByTagName("TotalQty")[0].childNodes[0].nodeValue);}
   catch(e){TotalQtyProdCart="0"}
   
   try{subtotalProdCart=(z[0].getElementsByTagName("subtotal")[0].childNodes[0].nodeValue);}
   catch(e){subtotalProdCart="0,00"}
   var iItensCesta=TotalQtyProdCart;
   var sProdutosNaCesta="";
   for (i=0;i&lt;x.length;i++)
   { 
     var ImgProdCart=(x[i].getElementsByTagName("image")[0].childNodes[0].nodeValue);
     var NomeProdCart=(x[i].getElementsByTagName("prod")[0].childNodes[0].nodeValue);
     var qtyProdCart=(x[i].getElementsByTagName("qty")[0].childNodes[0].nodeValue);
     var priceProdCart=(x[i].getElementsByTagName("price")[0].childNodes[0].nodeValue);
     var idProdCart=(x[i].getElementsByTagName("id")[0].childNodes[0].nodeValue);
     if(i>0)sProdutosNaCesta+="&lt;tr height=1>&lt;td colspan=4 align=center>&lt;img src='images/shim.gif' style='background: #d1d0d0'  width=300 height=1>&lt;/td>&lt;/tr>";
     sProdutosNaCesta+="&lt;tr>&lt;td class=ImgProdCart>&lt;a href='listaprodutos.asp?idloja="+FC$.IDLoja+"&amp;idproduto="+ idProdCart +"'>&lt;img src='"+ImgProdCart+"' border='0'>&lt;/a>&lt;/td>&lt;td class=NomeProdCart width=130>&lt;a href='listaprodutos.asp?idloja="+FC$.IDLoja+"&amp;idproduto="+ idProdCart +"' style='text-decoration:none;'>"+ NomeProdCart.substring(0,22) + "&lt;/a>&lt;/td>&lt;td class=QtdProdCart>(" + qtyProdCart + ")&lt;/td>&lt;td align=right class=PrecoProdCart nowrap>" + currencyProdCart + " " + priceProdCart + "&lt;/td>&lt;/tr>";
   }
   if(sProdutosNaCesta==""){sProdutosNaCesta+="&lt;tr height=40>&lt;td width=300 height=180 align=center class=ImgProdCartVazio>&lt;/td>&lt;/tr>";}
     try{document.getElementById("carrinho-produtos").innerHTML="&lt;table width=300>"+ sProdutosNaCesta +"&lt;/table>";}catch(e){}
     try{document.getElementById("x1").innerHTML="&lt;b>Item(s):&lt;/b>&amp;nbsp;"+iItensCesta;}catch(e){}
     try{document.getElementById("x2").innerHTML="&lt;b>SubTotal:&lt;/b>&amp;nbsp;"+currencyProdCart + " " + subtotalProdCart;}catch(e){}
}
</pre>
          </span></td>
        </tr>
      </table> 				
    </td>
  </tr>
  <tr>
    <td><br><br><br></td>
  </tr>
  <tr>
    <td><span class=destpeq>6º Passo</span><br />Adicione as linhas abaixo no final do arquivo <b>LojaSite.css</b><br></td>
  </tr>
  <tr>
    <td><br></td>
  </tr>
  <tr>
    <td>
      <table cellpadding=10 cellspacing=1>
        <tr>
          <td><span class=courrierpeq><pre>ul#produtos{ list-style:none; }<br>ul#produtos li{float: left;background-color:#fff; }<br>div#carrinho-top{position:relative;z-index: 9999;}<br>div#carrinho-info{position:relative; display: block; background: url(../images/BgCart.png) no-repeat;  height:42px; width: 250px; left: 20px; top:auto; z-index: 9999; }<br>div#carrinho-container{position:absolute;background: url(../images/BgContainer.png) no-repeat; width:327px; height:280px; display:none;  z-index: 9999}<br>div#carrinho-container ul{ overflow:auto; height:206px; padding: 14 0 0 8; margin:0px;list-style:none; z-index: 9999}<br>div#carrinho-container ul li{ color:#333; font-size:12px;  text-align:center; margin:0px;z-index: 9999}<br>#result-adicao{font: 12px "Arial"; color: #000; display: none; float: left}<br>#bot-cesta{ margin: 0 0 5 14; display: block}<br>#carrinho-produtos{ height: 100%;z-index:9999}<br>#x1, #x2{color: #000;font-family:tahoma,Arial;font-size:8pt;float: left; padding-top: 13px; padding-left: 7px;}<br>#sMsg{font-size:8pt;}<br>.produto-drag{ background: url(../images/BgDrag.png) no-repeat; padding:10px;margin:0;width:131px;height:143px;text-align: center; z-index: 9999}<br>.ui-state-hover{background: url(../images/BgContainerHover.png) no-repeat; font-weight: bold;}<br>.ImgProdCartVazio{ background: url(../images/ImgProdCartVazio.png) no-repeat;}<br>.ImgProdCart img{width:30px;height:30px; }<br>.NomeProdCart a{font-family:tahoma,Arial;font-size:8pt;color:#000}<br>.QtdProdCart{font-family:tahoma,Arial;font-size:8pt;color:#000}<br>.PrecoProdCart{font-family:tahoma,Arial;font-size:8pt;color:#000;font-weight:bold}<br>.Cesta{width: 241px; height:42px; float:right; margin: 0; display: block}</pre></span></td>
        </tr>
      </table>
    </td>
  </tr>
  <tr>
    <td><br><br><br></td>
  </tr>
  <tr>
    <td><span class=destpeq>7º Passo</span><br /><b>Incluindo a funcionalidade de arraste na home da loja</b><br></td>
  </tr>
  <tr>
    <td>O arquivo Home.htm entre as tags <b>&lt;prod></b> deve conter a tag <b>&lt;ul id="produtos"></b>. Exemplo:</td>
  </tr>
  <tr>
    <td><br></td>
  </tr>
  <tr>
    <td>
      <table cellpadding=10 cellspacing=1>
        <tr>
          <td><span class=courrierpeq><pre>&lt;table><br>  &lt;tr><br>    &lt;td><br>      &lt;ul id="produtos"><br>        &lt;div style="float:left">&lt;prod out="p5" em="rand">&lt;/div><br>        &lt;div style="float:left">&lt;prod out="p5" em="rand">&lt;/div><br>        &lt;div style="float:left">&lt;prod out="p5" em="rand">&lt;/div><br>        &lt;div style="float:left">&lt;prod out="p5" em="rand">&lt;/div><br>      &lt;/ul>    <br>    &lt;/td><br>  &lt;/tr><br>&lt;/table></pre></span></td>
        </tr>
      </table>
    </td>
  </tr>
  <tr>
    <td><br></td>
  </tr>
  <tr>
    <td>O arquivo <b>EstiloProdutoOut.htm</b> entre as tags <b>&lt;p></b> deve conter a tag <b>&lt;li class="produto"></b> e dentro dela os inputs e form. Exemplo:</td>
  </tr>
  <tr>
    <td><br></td>
  </tr>
  <tr>
    <td>
      <table cellpadding=10 cellspacing=1>
        <tr>
          <td><span class=courrierpeq><pre>&lt;p255><br> &lt;table><br>  &lt;tr>&lt;td class="EstNomeProd">&lt;NomeProd>&lt;/td>&lt;/tr><br>  &lt;tr>&lt;td><br>    &lt;li class="produto"><br>     &lt;input type="hidden" class="produto-id" value="&lt;IDProduto>"/><br>     &lt;input type="hidden" class="produto-id-loja" value="&lt;IDLoja>"/><br>     &lt;form name="Form&lt;IDProduto>">	<br>      &lt;div>&lt;a href='/prod,idloja,&lt;idlojanum>,idproduto,&lt;IDProduto>,&lt;NomeProdUA>' rel="&lt;IDProduto>">&lt;ImagemProd>&lt;/a>&lt;/div><br>     &lt;/form>	<br>    &lt;/li><br>  &lt;/td>&lt;/tr><br>  &lt;tr>&lt;td class="EstPrecoProd">&lt;PrecoSimples>&lt;/td>&lt;/tr><br> &lt;/table><br>&lt;/p255></pre></span></td>
        </tr>
      </table>
    </td>
  </tr>
  <tr>
    <td><br><br><br></td>
  </tr>
  <tr>
    <td><span class=destpeq>8º Passo</span><br /><b>Adicionando arraste na listagem e na página de detalhe do produto</b><br></td>
  </tr>
  <tr>
    <td>O arquivo <b>EstiloProduto.htm</b> entre as tags <b>&lt;ProdTop></b> e <b>&lt;/ProdTop></b> deve conter a tag <b>&lt;ul id="produtos"></b>. Exemplo:</td>
  </tr>
  <tr>
    <td><br></td>
  </tr>
  <tr>
    <td>
      <table cellpadding=10 cellspacing=1>
        <tr>
          <td><span class=courrierpeq><pre>&lt;ProdTop><br>&nbsp;&nbsp;&lt;ul id="produtos"><br>&lt;/ProdTop></pre></span></td>
        </tr>
      </table>
    </td>
  </tr>        
  <tr>
    <td><br></td>
  </tr> 
  <tr>
    <td>O arquivo <b>EstiloProduto.htm</b> entre as tags <b>&lt;ProdBottom></b> e <b>&lt;/ProdBottom></b> deve conter a tag <b>&lt;/ul></b>. Exemplo:</td>
  </tr>
  <tr>
    <td><br></td>
  </tr>
  <tr>
    <td>
      <table cellpadding=10 cellspacing=1>
        <tr>
          <td><span class=courrierpeq><pre>&lt;ProdBottom><br>&nbsp;&nbsp;&lt;/ul><br>&lt;/ProdBottom></pre></span></td>
        </tr>
      </table>
    </td>
  </tr>        
  <tr>
    <td><br></td>
  </tr>
  <tr>
    <td><b>Adicionando arraste no detalhe de produto</b><br></td>
  </tr>
  <tr>
    <td>O arquivo <b>EstiloProduto.htm</b> entre as tags <b>&lt;ProdDet></b> e <b>&lt;/ProdDet></b> deve conter a tag <b>&lt;li class="produto"></b> e dentro<br>dela os inputs. Exemplo:</td>
  </tr>
  <tr>
    <td><br></td>
  </tr>
  <tr>
    <td>
      <table cellpadding=10 cellspacing=1>
        <tr>
          <td><span class=courrierpeq>    	
<pre>
&lt;ProdDet>
  &lt;table>
    &lt;tr>
      &lt;td>
        &lt;li class="produto">
            &lt;input type="hidden" class="produto-id" value="&lt;IDProduto>"/>
            &lt;input type="hidden" class="produto-id-loja" value="&lt;IDLoja>"/>
            &lt;img class="EstImgFC" src="&lt;ImagemProdDet>"/>
        &lt;/li>          
      &lt;/td>
    &lt;/tr>
  &lt;/table>
&lt;/ProdDet>
</pre>
          </span></td>
        </tr>
      </table>
    </td>
  </tr>
  <tr><td><br><br><br></td></tr>
  <tr>
    <td><b>Adicionando arraste na listagem de produtos</b><br></td>
  </tr>
  <tr>
    <td>O arquivo <b>EstiloProduto.htm</b> entre as tags <b>&lt;ProdLista></b> e <b>&lt;/ProdLista></b> deve conter a tag <b>&lt;li class="produto"></b> e dentro<br>dela os inputs. Exemplo:</td>
  </tr>
  <tr>
    <td><br></td>
  </tr>
  <tr>
    <td>
      <table cellpadding=10 cellspacing=1>
        <tr>
          <td><span class=courrierpeq>
<pre>
&lt;ProdLista>
  &lt;table>
    &lt;tr>
      &lt;td>
        &lt;li class="produto">
          &lt;input type="hidden" class="produto-id" value="&lt;IDProduto>"/>
          &lt;input type="hidden" class="produto-id-loja" value="&lt;IDLoja>"/>
          &lt;div class="EstImgFC">&lt;ImagemProd>&lt;/div>
        &lt;/li>
      &lt;/td>
    &lt;/tr>
  &lt;/table>
&lt;/ProdLista>
</pre>
          </span></td>
        </tr>
      </table>
    </td>
  </tr>
</table>